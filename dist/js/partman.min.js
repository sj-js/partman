function PartMan(t){this.globalOption={partMarginHeight:null,firstPartMarginHeight:50,lastPartMarginHeight:50},this.nowPartFoldElement,this.nowPartFoldAnchorElement,this.hiddenDiv=newEl("div").setStyle("width","100%").setStyle("height","100%").setStyle("display","block").setStyle("position","absolute").setStyle("left","-5555px").setStyle("top","-5555px").returnElement(),this.partFoldContextElement=newEl("div").addClass("part-fold-context").returnElement(),this.partFoldAnchorIdAndDataMap={},this.partFoldIdAndDataMap={};var e=this;window.addEventListener("resize",function(t){e.resizePartAreaElement()}),t&&this.setup(t)}try{var crossman=require("@sj-js/crossman"),ready=crossman.ready,getEl=crossman.getEl,newEl=crossman.newEl,searchEl=crossman.searchEl,getData=crossman.getData,SjEvent=crossman.SjEvent}catch(e){}try{module.exports=exports=PartMan}catch(e){}PartMan.prototype.setup=function(t){for(var e in t)this.globalOption[e]=t[e];return this},PartMan.prototype.detect=function(t){var e=this;return ready(function(){e.makeImg(),e.makePartAreaElement(),e.makePartFoldElement(),t&&t(e)}),this},PartMan.prototype.makePartFoldElement=function(){var t=this;searchEl("[data-part-fold]").each(function(e){var a=getEl(e).attr("data-part-fold"),n=a?a:e.id?e.id:"partFoldData"+(new Date).getTime();t.partFoldIdAndDataMap[n]={element:e},getEl(e).attr("data-part-fold",n)}),searchEl("[data-part-fold-a]").each(function(e){var a=getEl(e).attr("data-part-fold-a"),n=a?a:e.id?e.id:"partFoldAnchorData"+(new Date).getTime();t.partFoldAnchorIdAndDataMap[n]={element:e},getEl(e).attr("data-part-fold-a",n).addEventListener("click",function(a){var n=getEl(e).attr("data-part-fold-a");t.toggleContent(n)})}),getEl(this.hiddenDiv).appendTo(document.body),this.closeContentAll(),getData().isMobile||window.addEventListener("resize",function(e){t.whenResize()})},PartMan.prototype.toggleContent=function(t){var e=this,a=this.getPartFoldAnchorElement(t),n=this.getPartFoldElement(t);return!(!a||!n)&&void getEl(n).exists(function(a){getEl(a).hasClass("content-none")?e.openContent(t):e.closeContentAll()})},PartMan.prototype.openContent=function(t){var e=this,a=this.getPartFoldAnchorElement(t),n=this.getPartFoldElement(t);if(!a||!n)return!1;this.closeContentAll(),this.nowPartFoldElement=n,this.nowPartFoldAnchorElement=a,searchEl("[data-part-fold-a]").each(function(t){getEl(t).removeClass("part-fold-active")}),getEl(a).addClass("part-fold-active");var o=null,r=null;searchEl("[data-part-fold-a]").some(function(t){return a.offsetTop<t.offsetTop?(o=t,!0):void(a.offsetTop==t.offsetTop&&(r=t.nextSibling))}),null==o&&(o=r),getEl(e.partFoldContextElement).add(getEl(n).removeClass("content-none").setStyle("minHeight",n.scrollHeight>300?n.scrollHeight+"px":"300px").addAsFirst([searchEl("[data-part-fold-tool]").each(function(t){getEl(t).setStyle("display","block")})]).add([])).appendToFrontOf(o),e.moveScroll(a,n)},PartMan.prototype.closeContentAll=function(){var t=this;searchEl("[data-part-fold-a]").each(function(e){getEl(e).removeClass("part-fold-active");var a=getEl(e).attr("data-part-fold-a"),n=t.getPartFoldElement(a);getEl(n).exists(function(e){e.addClass("content-none").setStyle("minHeight","0px").appendTo(t.hiddenDiv)})}),getEl(t.hiddenDiv).add([t.partFoldContextElement,searchEl("[data-part-fold-tool]")])},PartMan.prototype.whenResize=function(){if(this.nowPartFoldElement||this.nowPartFoldAnchorElement){var t=this,e=null,a=null;getEl(this.hiddenDiv).add(this.partFoldContextElement),searchEl("[data-part-fold-a]").some(function(n){return t.nowPartFoldAnchorElement.offsetTop<n.offsetTop?(e=n,!0):void(t.nowPartFoldAnchorElement.offsetTop==n.offsetTop&&(a=n.nextSibling))}),null==e&&(e=a),getEl(this.partFoldContextElement).appendToFrontOf(e)}},PartMan.prototype.moveScroll=function(t,e){var a=-55;setTimeout(function(){document.documentElement.scrollTop=t.offsetTop+a},50),setTimeout(function(){document.documentElement.scrollTop=t.offsetTop+a},100),setTimeout(function(){document.documentElement.scrollTop=t.offsetTop+a,e.style.height="auto"},125),setTimeout(function(){document.documentElement.scrollTop=t.offsetTop+a},150)},PartMan.prototype.getPartFoldElement=function(t){var e=this.partFoldIdAndDataMap[t];if(e)return e.element},PartMan.prototype.getPartFoldAnchorElement=function(t){var e=this.partFoldAnchorIdAndDataMap[t];if(e)return e.element},PartMan.prototype.eachPartIcon=function(t){var e=null;for(var a in this.partFoldAnchorIdAndDataMap)e=this.partFoldAnchorIdAndDataMap[a].element,t(e);return this},PartMan.prototype.makeImg=function(){searchEl("[data-img]").each(function(t){t.isAdaptedImg||(t.isAdaptedImg=!0,t.img=new Image,t.img.src=t.getAttribute("data-img"),t.style.backgroundImage="url("+t.img.src+")",t.style.backgroundRepeat="no-repeat",t.style.backgroundPosition="center",t.style.backgroundSize="100% 100%",t.img.objDiv=t,t.img.onload=function(){var t=this.objDiv.getAttribute("width"),e=this.objDiv.getAttribute("height");this.objDiv.style.width=t?t+"px":this.width+"px",this.objDiv.style.height=e?e+"px":this.height+"px"})})},PartMan.prototype.makePartAreaElement=function(){var t=searchEl("[data-part]").returnElement();if(0!=t.length){var e=null;e=t[0],newEl("div").attr("data-part-margin",!0).setStyle("background","linear-gradient(rgba(255,255,255,0), "+e.style.background+")").appendToFrontOf(e),e=t[t.length-1],newEl("div").attr("data-part-margin",!0).setStyle("background","linear-gradient("+e.style.background+", rgba(255,255,255,0))").appendToNextOf(e);for(var a=0;a<t.length-1;a++){e=t[a];var n=t[a+1];newEl("div").attr("data-part-margin",!0).setStyle("background","linear-gradient("+e.style.background+", "+n.style.background+")").appendToFrontOf(n)}this.resizePartAreaElement()}},PartMan.prototype.resizePartAreaElement=function(){var t=window.innerHeight,e=Math.floor(t/2+1);searchEl("[data-part]").each(function(e){getEl(e).setStyle("minHeight",t+"px")});var a=searchEl("[data-part-margin]").returnElement();if(!(a.length<2)){var n=null,o=null!=this.globalOption.partMarginHeight?this.globalOption.partMarginHeight:e,r=null!=this.globalOption.firstPartMarginHeight?this.globalOption.firstPartMarginHeight:o,l=null!=this.globalOption.lastPartMarginHeight?this.globalOption.lastPartMarginHeight:o;n=a[0],getEl(n).setStyle("height",r+"px"),getEl(a[a.length-1]).setStyle("height",l+"px");for(var i=1;i<a.length-1;i++)getEl(a[i]).setStyle("height",o+"px")}};